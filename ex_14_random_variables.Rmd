---
title: "Ex 14 Random Variables"
output:
  html_document:
    df_print: paged
    number_sections: true
    toc: true
    pandoc_args: [
      "--number-sections",
      "--number-offset=14"
      ]
---

## Exercises Random Variables

### Qn

>1\. In American Roulette you can also bet on green. There are 18 reds, 18 blacks and 2 greens (0 and 00). What are the chances the green comes out?

Variant in Book: 
Gambler can bet a dollar ($1) on red or black to win a dollar, the payout is a dollar and the casino loses one dollar. If the gambler bets on red and the ball lands in a green or black pocket, the gambler loses, but the casino ("bank") wins.
The chances are 18/38(=9/19): lose for the casino, win for the gambler and 20/38(=10/19): win for casino, lose for gambler.
If the gambler is allowed to bet on green then he loses if the ball lands on red or black.\

Therefore, the chances 2/38(=1/19) to lose for the gambler and 36/38(=18/19) to win for the casino. If the payout would stay at $1 this game is rather disadvantageous for the gambler.


### Qn
>2\. The payout for winning on green is \$17 dollars. This means that if you bet a dollar and it lands on green, you get \$17. Create a sampling model using sample to simulate the random variable $X$ for your winnings. Hint: see the example below for how it should look like when betting on red.
>
>```{r, eval=FALSE}
>x <- sample(c(1,-1), 1, prob = c(9/19, 10/19))
>```

In this variant the gambler is betting a dollar but can win \$17 or lose a dollar. The casino, on the other hand, can win a dollar or lose $17. This variant is more attractive for the gambler but rises the risk of losing money for the casino.

```{r}
X <- sample(c(1,-17), 1, prob=c(18/19, 1/19))
X
```

### Qn
>3\. Compute the expected value of $X$.

Here $a=-17$ and $b=1$ with $p=1/19$ and $(1-p)=18/19$.
$$
\mbox{E}[X] = ap + b(1-p)
$$ 
Here the expected value would be 5 cent.
$$
-17*1/19+1*18/19=1/19\approx0.05
$$

This is the same expected value as betting on red. 
Therefore if 1000 people would bet on green the expected win for the casino stays at \$50.

By the way, the probability of hitting green is also $1/19\approx0.05$, where the probability of hitting red is about a hundred times larger $9/19\approx0.5$.

### Qn
>4\. Compute the standard error of $X$.

$$
\mbox{SE}[X]=\mid b - a \mid \sqrt{(1-p)p}
$$
In this case the standard error of $X$ is 
$$
\mid 1 - (-17) \mid \sqrt{18/19 \times 1/19}=18*\sqrt{\frac{18}{361}}=18*\frac{\sqrt{18}}{19}\approx4
$$

In numbers this results to $\approx$\$4.

```{r}
18 * sqrt(18)/19
```

If 1000 people would bet on green the casino is expected to loose about $120, which is not very advantageous for the casino.
```{r}
n<-10^3
sqrt(n) *17 * sqrt(18)/19
```


### Qn
>5\. Now create a random variable $S$ that is the sum of your winnings after betting on green 1000 times. Hint: change the argument `size` and `replace` in your answer to question 2. Start your code by setting the seed to 1 with `set.seed(1)`.

```{r}
set.seed(1)
n<-10^3
X <- sample(c(-17,1), n, replace = TRUE, prob=c(1/19, 18/19))
S<-sum(X)
S
```

### Qn
>6\. What is the expected value of $S$?

```{r}
set.seed(1)
n<-10^3
X <- sample(c(-17,1), n, replace = TRUE, prob=c(1/19, 18/19))
S<-sum(X)/length(X)
S
```

### Qn
>7\. What is the standard error of $S$?

```{r}
set.seed(1)
n<-10^3
X <- sample(c(-17,1), n, replace = TRUE, prob=c(1/19, 18/19))
S<-sum(X)/length(X)
SE<-sqrt(sum((X - S)^2) / length(X))
SE
```

### Qn
>8\. What is the probability that you end up winning money? Hint: use the CLT.

```{r}
set.seed(1)
n<-10^3
B <- 10^4
roulette_winnings <- function(n){
  X <- sample(c(-17,1), n, replace = TRUE, prob=c(1/19, 18/19))
  sum(X)
}
C <- replicate(B, roulette_winnings(n))

S<-sum(C)/length(C)
SE<-sqrt(sum((C - S)^2) / length(c))
S
SE
```
```{r}
n <- 1000
B <- 10000
roulette_winnings <- function(n){
  X <- sample(c(-17,1), n, replace = TRUE, prob=c(1/19, 18/19))
  sum(X)
}
S <- replicate(B, roulette_winnings(n))

n * (2-36)/38 
#> [1] 52.6
sqrt(n) * 2 * sqrt(18)/19 
#> [1] 31.6

mean(S)
#> [1] 52.2
sd(S)
#> [1] 31.7
mean(S < 0)
#> [1] 0.0458

# CLT
mu <- n * (2-36)/38
se <-  sqrt(n) * 2 * sqrt(18)/19 
pnorm(0, mu, se)
#> [1] 0.0478
```

```{r}
n <- 1000
B <- 10000
roulette_winnings <- function(n){
  X <- sample(c(-1,1), n, replace = TRUE, prob=c(9/19, 10/19))
  sum(X)
}
S <- replicate(B, roulette_winnings(n))

n * (20-18)/38 
#> [1] 52.6
sqrt(n) * 2 * sqrt(90)/19 
#> [1] 31.6

mean(S)
#> [1] 52.2
sd(S)
#> [1] 31.7
mean(S < 0)
#> [1] 0.0458

# CLT
mu <- n * (20-18)/38
se <-  sqrt(n) * 2 * sqrt(90)/19 
pnorm(0, mu, se)
#> [1] 0.0478
```
### Qn
>9\. Create a Monte Carlo simulation that generates 1,000 outcomes of $S$. Compute the average and standard deviation of the resulting list to confirm the results of 6 and 7. Start your code by setting the seed to 1 with `set.seed(1)`.


### Qn
>10\. Now check your answer to 8 using the Monte Carlo result. 

### Qn
>11\. The Monte Carlo result and the CLT approximation are close, but not that close. What could account for this?
>
>a. 1,000 simulations is not enough. If we do more, they match.
>b. The CLT does not work as well when the probability of success is small. In this case, it was 1/19. If we make the number of roulette plays bigger, they will match better.
>c. The difference is within rounding error.
>d. The CLT only works for averages.


### Qn
>12\. Now create a random variable $Y$ that is your average winnings per bet after playing off your winnings after betting on green 1,000 times.


### Qn
>13\. What is the expected value of $Y$?

### Qn
>14\. What is the standard error of $Y$?

### Qn
>15\. What is the probability that you end up with winnings per game that are positive? Hint: use the CLT.


### Qn
>16\. Create a Monte Carlo simulation that generates 2,500 outcomes of $Y$. Compute the average and standard deviation of the resulting list to confirm the results of 6 and 7. Start your code by setting the seed to 1 with `set.seed(1)`.

### Qn
>17\. Now check your answer to 8 using the Monte Carlo result. 

### Qn
>18\. The Monte Carlo result and the CLT approximation are now much closer.  What could account for this?
>
>a. We are now computing averages instead of sums.
>b. 2,500 Monte Carlo simulations is not better than 1,000.
>c. The CLT works better when the sample size is larger. We increased from 1,000 to 2,500.
>d. It is not closer. The difference is within rounding error.
